# Dicio 模型下载与语言支持分析

## 1. 需要手动下载的模型

### 1.1 OpenWakeWord 唤醒词检测模型

#### 模型功能
OpenWakeWord 是一个开源的唤醒词检测系统，用于检测用户说出的唤醒词（如"Hey Dicio"）来激活语音助手。

#### 下载链接
- **Mel频谱图模型**: `https://github.com/dscripka/openWakeWord/releases/download/v0.5.1/melspectrogram.tflite`
- **嵌入模型**: `https://github.com/dscripka/openWakeWord/releases/download/v0.5.1/embedding_model.tflite`  
- **唤醒词模型**: `https://github.com/Stypox/dicio-android/releases/download/v2.0/hey_dicio_v6.0.tflite`

#### 保存位置
- **目标目录**: `{应用数据目录}/openWakeWord/`
- **具体文件**:
  - `melspectrogram.tflite` - Mel频谱图处理模型
  - `embedding.tflite` - 特征嵌入模型  
  - `wake.tflite` - 唤醒词检测模型
  - `userwake.tflite` - 用户自定义唤醒词模型（可选）

#### 模型大小与用途
- **melspectrogram.tflite**: 用于将音频转换为Mel频谱图特征
- **embedding.tflite**: 用于提取音频特征嵌入
- **wake.tflite**: 用于检测"Hey Dicio"唤醒词
- **userwake.tflite**: 支持用户上传自定义唤醒词模型

### 1.2 Vosk 语音识别模型

#### 模型功能
Vosk 是一个开源的语音识别引擎，支持多种语言的语音转文本功能。

#### 支持的语言与下载链接

| 语言代码 | 语言名称 | 下载链接 |
|---------|---------|---------|
| en | 英语 (美式) | https://alphacephei.com/vosk/models/vosk-model-small-en-us-0.15.zip |
| en-in | 英语 (印度) | https://alphacephei.com/vosk/models/vosk-model-small-en-in-0.4.zip |
| cn | 中文 | https://alphacephei.com/vosk/models/vosk-model-small-cn-0.22.zip |
| ko | 韩语 | https://alphacephei.com/vosk/models/vosk-model-small-ko-0.22.zip |
| ru | 俄语 | https://alphacephei.com/vosk/models/vosk-model-small-ru-0.22.zip |
| fr | 法语 | https://alphacephei.com/vosk/models/vosk-model-small-fr-0.22.zip |
| de | 德语 | https://alphacephei.com/vosk/models/vosk-model-small-de-0.15.zip |
| es | 西班牙语 | https://alphacephei.com/vosk/models/vosk-model-small-es-0.42.zip |
| pt | 葡萄牙语 | https://alphacephei.com/vosk/models/vosk-model-small-pt-0.3.zip |
| tr | 土耳其语 | https://alphacephei.com/vosk/models/vosk-model-small-tr-0.3.zip |
| vn | 越南语 | https://alphacephei.com/vosk/models/vosk-model-small-vn-0.4.zip |
| it | 意大利语 | https://alphacephei.com/vosk/models/vosk-model-small-it-0.22.zip |
| nl | 荷兰语 | https://alphacephei.com/vosk/models/vosk-model-small-nl-0.22.zip |
| ca | 加泰罗尼亚语 | https://alphacephei.com/vosk/models/vosk-model-small-ca-0.4.zip |
| ar | 阿拉伯语 | https://alphacephei.com/vosk/models/vosk-model-ar-mgb2-0.4.zip |
| ar-tn | 阿拉伯语 (突尼斯) | https://alphacephei.com/vosk/models/vosk-model-small-ar-tn-0.1-linto.zip |
| fa | 波斯语 | https://alphacephei.com/vosk/models/vosk-model-small-fa-0.42.zip |
| ph | 菲律宾语 | https://alphacephei.com/vosk/models/vosk-model-tl-ph-generic-0.6.zip |
| uk | 乌克兰语 | https://alphacephei.com/vosk/models/vosk-model-small-uk-v3-nano.zip |
| kz | 哈萨克语 | https://alphacephei.com/vosk/models/vosk-model-small-kz-0.15.zip |
| sv | 瑞典语 | https://alphacephei.com/vosk/models/vosk-model-small-sv-rhasspy-0.15.zip |
| ja | 日语 | https://alphacephei.com/vosk/models/vosk-model-small-ja-0.22.zip |
| eo | 世界语 | https://alphacephei.com/vosk/models/vosk-model-small-eo-0.42.zip |
| hi | 印地语 | https://alphacephei.com/vosk/models/vosk-model-small-hi-0.22.zip |
| cs | 捷克语 | https://alphacephei.com/vosk/models/vosk-model-small-cs-0.4-rhasspy.zip |
| pl | 波兰语 | https://alphacephei.com/vosk/models/vosk-model-small-pl-0.22.zip |
| uz | 乌兹别克语 | https://alphacephei.com/vosk/models/vosk-model-small-uz-0.22.zip |
| br | 布列塔尼语 | https://alphacephei.com/vosk/models/vosk-model-br-0.8.zip |
| gu | 古吉拉特语 | https://alphacephei.com/vosk/models/vosk-model-small-gu-0.42.zip |
| tg | 塔吉克语 | https://alphacephei.com/vosk/models/vosk-model-small-tg-0.22.zip |
| te | 泰卢固语 | https://alphacephei.com/vosk/models/vosk-model-small-te-0.42.zip |

#### 保存位置
- **下载临时文件**: `{应用数据目录}/vosk-model.zip`
- **解压后目录**: `{应用数据目录}/vosk-model/`
- **URL检查文件**: `{应用数据目录}/vosk-model-url`

#### 下载流程
1. 根据当前语言选择对应的模型URL
2. 下载ZIP文件到临时位置
3. 解压到目标目录
4. 删除ZIP文件节省空间
5. 创建URL检查文件记录当前模型版本

## 2. 语言支持分析

### 2.1 UI界面语言支持

#### 完整支持的语言 (有完整的strings.xml翻译)
- **英语** (en) - 基础语言
- **中文简体** (zh-CN) - 完整翻译
- **中文繁体** (zh-TW) - 完整翻译
- **德语** (de) - 完整翻译
- **法语** (fr) - 完整翻译
- **意大利语** (it) - 完整翻译
- **西班牙语** (es) - 完整翻译
- **俄语** (ru) - 完整翻译
- **捷克语** (cs) - 完整翻译
- **波兰语** (pl) - 完整翻译
- **荷兰语** (nl) - 完整翻译
- **瑞典语** (sv) - 完整翻译
- **乌克兰语** (uk) - 完整翻译

#### 部分支持的语言
- **韩语** (ko) - 仅有基础翻译，只有一个字符串
- **阿拉伯语** (ar) - 部分翻译
- **希腊语** (el) - 部分翻译
- **芬兰语** (fi) - 部分翻译
- **匈牙利语** (hu) - 部分翻译
- **印地语** (hi) - 部分翻译
- **其他多种语言** - 不同程度的翻译支持

### 2.2 语音识别支持

#### 重点语言分析

##### 英语支持
- **Vosk模型**: ✅ 支持 (en, en-in)
- **UI翻译**: ✅ 完整支持
- **技能句子**: ✅ 完整支持 (13个技能)
- **状态**: 完全支持

##### 中文支持  
- **Vosk模型**: ✅ 支持 (cn)
- **UI翻译**: ✅ 完整支持 (zh-CN, zh-TW)
- **技能句子**: ❌ 不支持 (无中文句子定义)
- **状态**: 语音识别和UI支持，但缺少技能句子定义

##### 韩语支持
- **Vosk模型**: ✅ 支持 (ko) 
- **UI翻译**: ⚠️ 极少支持 (仅一个字符串)
- **技能句子**: ❌ 不支持 (无韩语句子定义)
- **状态**: 仅语音识别支持，UI和技能严重缺失

### 2.3 技能句子定义支持

#### 完整支持的语言 (所有13个技能)
- **英语** (en) - 基准语言，包含所有技能
- **意大利语** (it) - 完整支持
- **德语** (de) - 完整支持  
- **法语** (fr) - 完整支持
- **西班牙语** (es) - 完整支持
- **瑞典语** (sv) - 完整支持

#### 部分支持的语言 (缺少部分技能)
- **捷克语** (cs) - 缺少media技能
- **波兰语** (pl) - 缺少media技能
- **俄语** (ru) - 缺少media技能
- **斯洛文尼亚语** (sl) - 缺少media技能
- **乌克兰语** (uk) - 缺少media技能
- **希腊语** (el) - 仅支持6个基础技能

#### 支持的技能类型
1. **calculator** - 计算器
2. **calculator_operators** - 计算器操作符
3. **current_time** - 当前时间
4. **lyrics** - 歌词查询
5. **media** - 媒体控制
6. **navigation** - 导航
7. **open** - 打开应用
8. **search** - 搜索
9. **telephone** - 电话
10. **timer** - 计时器
11. **util_yes_no** - 是/否确认
12. **weather** - 天气查询
13. **listening** - 监听控制

### 2.4 语言配置管理

#### 支持的应用语言设置
根据 `language.proto` 定义，应用支持以下语言设置：
- LANGUAGE_SYSTEM (0) - 跟随系统语言
- LANGUAGE_CS (1) - 捷克语
- LANGUAGE_DE (2) - 德语  
- LANGUAGE_EN (3) - 英语
- LANGUAGE_EN_IN (4) - 印度英语
- LANGUAGE_ES (5) - 西班牙语
- LANGUAGE_EL (6) - 希腊语
- LANGUAGE_FR (7) - 法语
- LANGUAGE_IT (8) - 意大利语
- LANGUAGE_PL (12) - 波兰语
- LANGUAGE_RU (9) - 俄语
- LANGUAGE_SL (10) - 斯洛文尼亚语
- LANGUAGE_SV (13) - 瑞典语
- LANGUAGE_UK (11) - 乌克兰语

**注意**: 配置中没有包含中文和韩语的语言选项。

## 3. 重点语言支持总结

### 3.1 英语 (English)
- ✅ **语音识别**: 完全支持 (2个模型变体)
- ✅ **UI界面**: 完全支持 (基础语言)
- ✅ **技能句子**: 完全支持 (13个技能)
- ✅ **语言设置**: 支持
- **总体评级**: ⭐⭐⭐⭐⭐ 完美支持

### 3.2 中文 (Chinese)  
- ✅ **语音识别**: 支持 (cn模型)
- ✅ **UI界面**: 完全支持 (简体/繁体)
- ❌ **技能句子**: 不支持 (无中文句子定义)
- ❌ **语言设置**: 不支持 (配置中缺失)
- **总体评级**: ⭐⭐⭐ 部分支持，缺少核心功能

### 3.3 韩语 (Korean)
- ✅ **语音识别**: 支持 (ko模型)  
- ❌ **UI界面**: 几乎不支持 (仅1个字符串)
- ❌ **技能句子**: 不支持 (无韩语句子定义)
- ❌ **语言设置**: 不支持 (配置中缺失)
- **总体评级**: ⭐ 极少支持，仅语音识别可用

## 4. 改进建议

### 4.1 中文支持改进
1. **添加中文句子定义**: 为所有13个技能创建中文句子定义文件
2. **语言配置**: 在 `language.proto` 中添加中文语言选项
3. **测试验证**: 确保中文语音识别与技能匹配正常工作

### 4.2 韩语支持改进  
1. **完善UI翻译**: 补充完整的韩语strings.xml翻译
2. **添加句子定义**: 创建韩语技能句子定义文件
3. **语言配置**: 在 `language.proto` 中添加韩语语言选项
4. **全面测试**: 进行韩语语音识别和技能匹配测试

### 4.3 通用改进
1. **模型管理**: 优化模型下载和缓存机制
2. **语言检测**: 改进自动语言检测和切换
3. **错误处理**: 增强不支持语言的错误提示
4. **文档完善**: 为开发者提供多语言支持开发指南

## 5. 技术实现细节

### 5.1 模型下载机制
- 使用 `BinaryFileDownloader` 进行文件下载
- 支持断点续传和进度回调
- 自动验证文件完整性
- 智能缓存管理

### 5.2 语言解析流程
1. 用户设置语言偏好
2. `LocaleManager` 解析语言配置
3. 检查技能句子定义可用性
4. 选择对应的Vosk模型
5. 初始化语音识别引擎

### 5.3 多语言资源管理
- 使用Android标准资源目录结构
- 支持RTL语言布局
- 动态语言切换无需重启
- 资源回退机制确保稳定性

2025-09-15 11:10:46,627 - INFO - 初始化OpenWakeWord训练器
2025-09-15 11:10:46,627 - INFO - 数据目录: scripts/training_data/korean_wake_word_tts
2025-09-15 11:10:46,627 - INFO - 输出目录: models/openwakeword_korean_v1
2025-09-15 11:10:46,627 - INFO - 音频参数: SR=16000, MEL_INPUT=1152
2025-09-15 11:10:46,627 - INFO - 开始加载数据集并提取mel特征...
2025-09-15 11:10:46,627 - INFO - 加载正样本从: scripts/training_data/korean_wake_word_tts/positive
2025-09-15 11:10:46,628 - INFO - 找到 100 个正样本文件
2025-09-15 11:10:56,982 - INFO - 已处理 20 个正样本
2025-09-15 11:10:57,003 - INFO - 已处理 40 个正样本
2025-09-15 11:10:57,024 - INFO - 已处理 60 个正样本
2025-09-15 11:10:57,044 - INFO - 已处理 80 个正样本
2025-09-15 11:10:57,065 - INFO - 已处理 100 个正样本
2025-09-15 11:10:57,065 - INFO - 加载负样本从: scripts/training_data/korean_wake_word_tts/negative
2025-09-15 11:10:57,066 - INFO - 找到 200 个负样本文件
2025-09-15 11:10:57,119 - INFO - 已处理 50 个负样本
2025-09-15 11:10:57,167 - INFO - 已处理 100 个负样本
2025-09-15 11:10:57,219 - INFO - 已处理 150 个负样本
2025-09-15 11:10:57,269 - INFO - 已处理 200 个负样本
2025-09-15 11:10:57,269 - INFO - 数据集加载完成:
2025-09-15 11:10:57,269 - INFO -   总样本数: 300
2025-09-15 11:10:57,269 - INFO -   正样本数: 100
2025-09-15 11:10:57,269 - INFO -   负样本数: 200
2025-09-15 11:10:57,269 - INFO -   Mel特征形状: (300, 5, 32)
2025-09-15 11:10:57,269 - INFO - 开始训练OpenWakeWord模型...
2025-09-15 11:10:57,269 - INFO - 创建端到端训练模型...
2025-09-15 11:10:57,272 - INFO - 创建嵌入模型...
2025-09-15 11:10:57,308 - INFO - 创建唤醒词分类模型...
2025-09-15 11:10:57,328 - INFO - 完整模型结构:
2025-09-15 11:10:57,330 - INFO - Model: "korean_wake_word_model"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ mel_spectrogram (InputLayer)         │ (None, 5, 32)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape (Reshape)                    │ (None, 5, 32, 1)            │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda (Lambda)                      │ (None, 76, 32, 1)           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ embedding_model (Functional)         │ (None, 1, 1, 96)            │         151,264 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape_2 (Reshape)                  │ (None, 1, 96)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda_1 (Lambda)                    │ (None, 16, 96)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ wake_model (Functional)              │ (None, 1)                   │         166,721 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 317,985 (1.21 MB)
 Trainable params: 317,537 (1.21 MB)
 Non-trainable params: 448 (1.75 KB)

2025-09-15 11:10:57,331 - INFO - 开始训练，数据形状: X=(300, 5, 32), y=(300,)
2025-09-15 11:11:01,343 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-09-15 11:11:01,363 - ERROR - 训练失败: Unable to serialize <__main__.OpenWakeWordKoreanTrainer object at 0x16dd64350> to JSON. Unrecognized type <class '__main__.OpenWakeWordKoreanTrainer'>.
2025-09-15 11:19:21,284 - INFO - 初始化OpenWakeWord训练器
2025-09-15 11:19:21,284 - INFO - 数据目录: scripts/training_data/korean_wake_word_tts
2025-09-15 11:19:21,284 - INFO - 输出目录: models/openwakeword_korean_v1
2025-09-15 11:19:21,284 - INFO - 音频参数: SR=16000, MEL_INPUT=1152
2025-09-15 11:19:21,284 - INFO - 开始加载数据集并提取mel特征...
2025-09-15 11:19:21,284 - INFO - 加载正样本从: scripts/training_data/korean_wake_word_tts/positive
2025-09-15 11:19:21,285 - INFO - 找到 100 个正样本文件
2025-09-15 11:19:22,216 - INFO - 已处理 20 个正样本
2025-09-15 11:19:22,237 - INFO - 已处理 40 个正样本
2025-09-15 11:19:22,259 - INFO - 已处理 60 个正样本
2025-09-15 11:19:22,280 - INFO - 已处理 80 个正样本
2025-09-15 11:19:22,301 - INFO - 已处理 100 个正样本
2025-09-15 11:19:22,301 - INFO - 加载负样本从: scripts/training_data/korean_wake_word_tts/negative
2025-09-15 11:19:22,302 - INFO - 找到 200 个负样本文件
2025-09-15 11:19:22,354 - INFO - 已处理 50 个负样本
2025-09-15 11:19:22,452 - INFO - 已处理 100 个负样本
2025-09-15 11:19:22,551 - INFO - 已处理 150 个负样本
2025-09-15 11:19:22,628 - INFO - 已处理 200 个负样本
2025-09-15 11:19:22,628 - INFO - 数据集加载完成:
2025-09-15 11:19:22,628 - INFO -   总样本数: 300
2025-09-15 11:19:22,628 - INFO -   正样本数: 100
2025-09-15 11:19:22,628 - INFO -   负样本数: 200
2025-09-15 11:19:22,628 - INFO -   Mel特征形状: (300, 5, 32)
2025-09-15 11:19:22,628 - INFO - 开始训练OpenWakeWord模型...
2025-09-15 11:19:22,628 - INFO - 创建端到端训练模型...
2025-09-15 11:19:22,639 - INFO - 创建嵌入模型...
2025-09-15 11:19:22,690 - INFO - 创建唤醒词分类模型...
2025-09-15 11:19:22,718 - INFO - 完整模型结构:
2025-09-15 11:19:22,721 - INFO - Model: "korean_wake_word_model"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ mel_spectrogram (InputLayer)         │ (None, 5, 32)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape (Reshape)                    │ (None, 5, 32, 1)            │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda (Lambda)                      │ (None, 76, 32, 1)           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ embedding_model (Functional)         │ (None, 1, 1, 96)            │         151,264 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape_2 (Reshape)                  │ (None, 1, 96)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda_1 (Lambda)                    │ (None, 16, 96)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ wake_model (Functional)              │ (None, 1)                   │         166,721 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 317,985 (1.21 MB)
 Trainable params: 317,537 (1.21 MB)
 Non-trainable params: 448 (1.75 KB)

2025-09-15 11:19:22,721 - ERROR - 训练失败: When using `save_weights_only=True` in `ModelCheckpoint`, the filepath provided must end in `.weights.h5` (Keras weights format). Received: filepath=models/openwakeword_korean_v1/best_model.keras
2025-09-15 11:19:56,119 - INFO - 初始化OpenWakeWord训练器
2025-09-15 11:19:56,120 - INFO - 数据目录: scripts/training_data/korean_wake_word_tts
2025-09-15 11:19:56,120 - INFO - 输出目录: models/openwakeword_korean_v1
2025-09-15 11:19:56,120 - INFO - 音频参数: SR=16000, MEL_INPUT=1152
2025-09-15 11:19:56,120 - INFO - 开始加载数据集并提取mel特征...
2025-09-15 11:19:56,120 - INFO - 加载正样本从: scripts/training_data/korean_wake_word_tts/positive
2025-09-15 11:19:56,120 - INFO - 找到 100 个正样本文件
2025-09-15 11:19:56,879 - INFO - 已处理 20 个正样本
2025-09-15 11:19:56,899 - INFO - 已处理 40 个正样本
2025-09-15 11:19:56,918 - INFO - 已处理 60 个正样本
2025-09-15 11:19:56,937 - INFO - 已处理 80 个正样本
2025-09-15 11:19:56,957 - INFO - 已处理 100 个正样本
2025-09-15 11:19:56,957 - INFO - 加载负样本从: scripts/training_data/korean_wake_word_tts/negative
2025-09-15 11:19:56,957 - INFO - 找到 200 个负样本文件
2025-09-15 11:19:57,010 - INFO - 已处理 50 个负样本
2025-09-15 11:19:57,062 - INFO - 已处理 100 个负样本
2025-09-15 11:19:57,113 - INFO - 已处理 150 个负样本
2025-09-15 11:19:57,164 - INFO - 已处理 200 个负样本
2025-09-15 11:19:57,164 - INFO - 数据集加载完成:
2025-09-15 11:19:57,164 - INFO -   总样本数: 300
2025-09-15 11:19:57,164 - INFO -   正样本数: 100
2025-09-15 11:19:57,164 - INFO -   负样本数: 200
2025-09-15 11:19:57,164 - INFO -   Mel特征形状: (300, 5, 32)
2025-09-15 11:19:57,164 - INFO - 开始训练OpenWakeWord模型...
2025-09-15 11:19:57,164 - INFO - 创建端到端训练模型...
2025-09-15 11:19:57,173 - INFO - 创建嵌入模型...
2025-09-15 11:19:57,216 - INFO - 创建唤醒词分类模型...
2025-09-15 11:19:57,241 - INFO - 完整模型结构:
2025-09-15 11:19:57,243 - INFO - Model: "korean_wake_word_model"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Layer (type)                         ┃ Output Shape                ┃         Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ mel_spectrogram (InputLayer)         │ (None, 5, 32)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape (Reshape)                    │ (None, 5, 32, 1)            │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda (Lambda)                      │ (None, 76, 32, 1)           │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ embedding_model (Functional)         │ (None, 1, 1, 96)            │         151,264 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ reshape_2 (Reshape)                  │ (None, 1, 96)               │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ lambda_1 (Lambda)                    │ (None, 16, 96)              │               0 │
├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤
│ wake_model (Functional)              │ (None, 1)                   │         166,721 │
└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘
 Total params: 317,985 (1.21 MB)
 Trainable params: 317,537 (1.21 MB)
 Non-trainable params: 448 (1.75 KB)

2025-09-15 11:19:57,244 - INFO - 开始训练，数据形状: X=(300, 5, 32), y=(300,)
2025-09-15 11:20:03,713 - INFO - 模型训练完成，耗时: 6.47 秒
2025-09-15 11:20:03,842 - INFO - 最终评估结果:
2025-09-15 11:20:03,842 - INFO -   验证损失: 1.5095
2025-09-15 11:20:03,842 - INFO -   验证准确率: 0.6667
2025-09-15 11:20:03,842 - INFO -   验证精确率: 0.0000
2025-09-15 11:20:03,842 - INFO -   验证召回率: 0.0000
2025-09-15 11:20:03,842 - INFO - 转换模型为TensorFlow Lite格式...
2025-09-15 11:20:03,849 - INFO - 转换 melspectrogram.tflite...
2025-09-15 11:20:03,879 - ERROR - 转换 melspectrogram.tflite 失败: 'Functional' object has no attribute '_get_save_spec'
2025-09-15 11:20:03,879 - INFO - 转换 embedding.tflite...
2025-09-15 11:20:03,906 - ERROR - 转换 embedding.tflite 失败: 'Functional' object has no attribute '_get_save_spec'
2025-09-15 11:20:03,906 - INFO - 转换 wake.tflite...
2025-09-15 11:20:03,956 - ERROR - 转换 wake.tflite 失败: 'Functional' object has no attribute '_get_save_spec'
2025-09-15 11:20:03,956 - INFO - 保存模型信息...
2025-09-15 11:20:03,956 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-09-15 11:20:03,961 - ERROR - 训练失败: Unable to serialize <__main__.OpenWakeWordKoreanTrainer object at 0x172316180> to JSON. Unrecognized type <class '__main__.OpenWakeWordKoreanTrainer'>.

# SenseVoiceåŒè¯†åˆ«åŠŸèƒ½çŠ¶æ€æŠ¥å‘Š

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

å·²ä¸ºDicio-Androidé›†æˆå®Œæ•´çš„åŒè¯†åˆ«æ¨¡å¼ï¼ˆTwo-Pass Recognitionï¼‰ï¼Œç»“åˆVoskå®žæ—¶è¯†åˆ«å’ŒSenseVoiceé«˜ç²¾åº¦è¯†åˆ«ï¼Œæä¾›æ›´å‡†ç¡®çš„è¯­éŸ³è¯†åˆ«ä½“éªŒã€‚

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. æ ¸å¿ƒæž¶æž„
- âœ… **TwoPassInputDevice**: åŒè¯†åˆ«ä¸»æŽ§åˆ¶å™¨
- âœ… **SenseVoiceRecognizer**: SenseVoice ONNXæŽ¨ç†å°è£…
- âœ… **SenseVoiceModelManager**: æ¨¡åž‹è·¯å¾„ç®¡ç†å’ŒéªŒè¯
- âœ… **AudioBuffer**: éŸ³é¢‘ç¼“å†²å’Œé¢„å¤„ç†

### 2. æ¨¡åž‹é›†æˆ
- âœ… **æ¨¡åž‹æ–‡ä»¶**: ä»ŽHandsFreeé¡¹ç›®æˆåŠŸå¤åˆ¶239MBé‡åŒ–SenseVoiceæ¨¡åž‹
  - `model.int8.onnx` (239MB)
  - `tokens.txt` (25,055ä¸ªtokens)
  - ä½ç½®: `app/src/withModels/assets/models/asr/sensevoice/`

### 3. è®¾ç½®ç•Œé¢
- âœ… **è®¾ç½®é€‰é¡¹**: "Two-Pass Recognition" å·²æ·»åŠ åˆ°è¯­éŸ³è¾“å…¥æ–¹æ³•
- âœ… **ç”¨æˆ·ç•Œé¢**: å®Œæ•´çš„ä¸­è‹±æ–‡å­—ç¬¦ä¸²èµ„æº
- âœ… **è®¾å¤‡æ³¨å†Œ**: åœ¨SttInputDeviceWrapperä¸­æ­£ç¡®æ³¨å†Œ

### 4. è¯¦ç»†æ—¥å¿—ç³»ç»Ÿ
- âœ… **åˆå§‹åŒ–æ—¥å¿—**: è¯¦ç»†çš„SenseVoiceåˆå§‹åŒ–æ­¥éª¤è®°å½•
- âœ… **æ¨¡åž‹åŠ è½½æ—¥å¿—**: æ¨¡åž‹è·¯å¾„ã€æ–‡ä»¶å¤§å°ã€æ¥æºä¿¡æ¯
- âœ… **è¯†åˆ«è¿‡ç¨‹æ—¥å¿—**: éŸ³é¢‘è´¨é‡ã€å¤„ç†æ—¶é—´ã€ç»“æžœå¯¹æ¯”
- âœ… **é”™è¯¯è¯Šæ–­æ—¥å¿—**: å¼‚å¸¸æƒ…å†µçš„è¯¦ç»†å †æ ˆè·Ÿè¸ª

## ðŸ”§ æŠ€æœ¯ç‰¹æ€§

### å·¥ä½œæµç¨‹
1. **ç¬¬ä¸€é˜¶æ®µ (Vosk)**:
   - æä¾›å®žæ—¶è¯­éŸ³è½¬æ–‡æœ¬åé¦ˆ
   - ä½Žå»¶è¿Ÿç”¨æˆ·ä½“éªŒ
   - åŒæ—¶ç¼“å­˜éŸ³é¢‘æ•°æ®

2. **ç¬¬äºŒé˜¶æ®µ (SenseVoice)**:
   - å»¶è¿Ÿ500msè§¦å‘
   - ä½¿ç”¨å®Œæ•´éŸ³é¢‘è¿›è¡Œé«˜ç²¾åº¦è¯†åˆ«
   - æ™ºèƒ½ç»“æžœé€‰æ‹©å’Œèžåˆ

### éŸ³é¢‘å¤„ç†
- **è´¨é‡æ£€æµ‹**: RMSã€å³°å€¼ã€é›¶äº¤å‰çŽ‡åˆ†æž
- **é¢„å¤„ç†**: é«˜é€šæ»¤æ³¢ã€éŸ³é‡å½’ä¸€åŒ–
- **ç¼“å†²ç®¡ç†**: æœ€å¤§30ç§’éŸ³é¢‘ç¼“å­˜
- **æœ€å°æ—¶é•¿æ£€æŸ¥**: è‡³å°‘1ç§’éŸ³é¢‘æ‰è§¦å‘ç¬¬äºŒé˜¶æ®µ

### æ™ºèƒ½å›žé€€
- **æ¨¡åž‹æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹SenseVoiceå¯ç”¨æ€§
- **ä¼˜é›…é™çº§**: SenseVoiceä¸å¯ç”¨æ—¶è‡ªåŠ¨ä½¿ç”¨çº¯Voskæ¨¡å¼
- **é”™è¯¯æ¢å¤**: å¼‚å¸¸æƒ…å†µçš„è‡ªåŠ¨å¤„ç†

## ðŸ“± ä½¿ç”¨æ–¹æ³•

### å¯ç”¨åŒè¯†åˆ«æ¨¡å¼
1. æ‰“å¼€Dicioåº”ç”¨
2. è¿›å…¥è®¾ç½® â†’ è¯­éŸ³è¾“å…¥æ–¹æ³•
3. é€‰æ‹© "Two-Pass Recognition"
4. æè¿°: "Real-time Vosk + High-accuracy SenseVoice"

### æ”¯æŒçš„ç‰ˆæœ¬
- **withModelsç‰ˆæœ¬**: æ¨¡åž‹å·²å†…ç½®ï¼Œç›´æŽ¥å¯ç”¨
- **noModelsç‰ˆæœ¬**: éœ€è¦å°†SenseVoiceæ¨¡åž‹æ”¾ç½®åˆ° `/storage/emulated/0/Dicio/models/sensevoice/`

## ðŸ› ï¸ è°ƒè¯•å’Œç›‘æŽ§

### ç›‘æŽ§è„šæœ¬
```bash
# å®žæ—¶ç›‘æŽ§SenseVoiceæ—¥å¿—
./monitor_sensevoice.sh

# åŠŸèƒ½æµ‹è¯•éªŒè¯
./test_sensevoice.sh

# å¿«é€ŸçŠ¶æ€æ£€æŸ¥
adb logcat -s TwoPassInputDevice | grep -E 'âœ…|âŒ|ðŸŽ¯|ðŸš€'
```

### å…³é”®æ—¥å¿—æ ‡ç­¾
- `TwoPassInputDevice`: åŒè¯†åˆ«ä¸»æµç¨‹
- `SenseVoiceRecognizer`: SenseVoiceæŽ¨ç†è¿‡ç¨‹
- `SenseVoiceModelManager`: æ¨¡åž‹ç®¡ç†
- `AudioBuffer`: éŸ³é¢‘ç¼“å†²å¤„ç†

## ðŸ“Š æ—¥å¿—ç¤ºä¾‹

### æˆåŠŸåˆå§‹åŒ–
```
TwoPassInputDevice: ðŸ”„ å¼€å§‹åˆå§‹åŒ–SenseVoiceè¯†åˆ«å™¨...
TwoPassInputDevice: ðŸ“‹ æ­¥éª¤1: æ£€æŸ¥SenseVoiceæ¨¡åž‹å¯ç”¨æ€§...
TwoPassInputDevice: ðŸ“‹ æ¨¡åž‹æ£€æŸ¥ç»“æžœ: âœ… å¯ç”¨
SenseVoiceRecognizer: ðŸ”§ SenseVoiceRecognizer.create() å¼€å§‹æ‰§è¡Œ...
SenseVoiceRecognizer: âœ… æ¨¡åž‹è·¯å¾„èŽ·å–æˆåŠŸ:
SenseVoiceRecognizer:    ðŸ“‚ æ¨¡åž‹: models/asr/sensevoice/model.int8.onnx
SenseVoiceRecognizer:    ðŸ“„ Tokens: models/asr/sensevoice/tokens.txt
SenseVoiceRecognizer: âœ… OfflineRecognizeråˆ›å»ºæˆåŠŸï¼
TwoPassInputDevice: âœ… SenseVoiceè¯†åˆ«å™¨åˆå§‹åŒ–æˆåŠŸï¼
TwoPassInputDevice: ðŸŽ¯ åŒè¯†åˆ«æ¨¡å¼å·²æ¿€æ´» (Vosk + SenseVoice)
```

### åŒè¯†åˆ«è¿‡ç¨‹
```
TwoPassInputDevice: ðŸŽ¯ è§¦å‘ç¬¬äºŒé˜¶æ®µè¯†åˆ«
TwoPassInputDevice:    ðŸ“ ç¬¬ä¸€é˜¶æ®µç»“æžœ: "hello world" (ç½®ä¿¡åº¦: 0.850)
TwoPassInputDevice: ðŸ“Š éŸ³é¢‘ç¼“å†²åŒºçŠ¶æ€: AudioBuffer(32000samples/2.00s)
TwoPassInputDevice: âœ… SenseVoiceè¯†åˆ«å™¨å¯ç”¨ï¼Œå¼€å§‹ç¬¬äºŒé˜¶æ®µè¯†åˆ«
TwoPassInputDevice: ðŸ§  æ‰§è¡ŒSenseVoiceæŽ¨ç†...
TwoPassInputDevice: ç¬¬äºŒé˜¶æ®µè¯†åˆ«å®Œæˆ: "Hello, world!" (1500ms)
TwoPassInputDevice: è¯†åˆ«å¯¹æ¯” - ç¬¬ä¸€é˜¶æ®µ: "hello world" -> ç¬¬äºŒé˜¶æ®µ: "Hello, world!" (æ”¹è¿›)
```

## ðŸŽ¯ é¢„æœŸæ•ˆæžœ

### æ€§èƒ½æŒ‡æ ‡
- **ç¬¬ä¸€é˜¶æ®µå»¶è¿Ÿ**: < 100ms (Voskå®žæ—¶)
- **ç¬¬äºŒé˜¶æ®µå»¶è¿Ÿ**: 1000-2000ms (SenseVoiceç¦»çº¿)
- **å‡†ç¡®çŽ‡æå‡**: ç›¸æ¯”å•ä¸€Voskè¯†åˆ«æé«˜10-20%
- **å†…å­˜å ç”¨**: é¢å¤–~300MB (SenseVoiceæ¨¡åž‹)

### ç”¨æˆ·ä½“éªŒ
- **å³æ—¶åé¦ˆ**: Voskæä¾›å®žæ—¶è¯†åˆ«ç»“æžœ
- **æœ€ç»ˆä¼˜åŒ–**: SenseVoiceæä¾›æ›´å‡†ç¡®çš„æœ€ç»ˆç»“æžœ
- **é€æ˜Žåˆ‡æ¢**: ç”¨æˆ·æ— æ„ŸçŸ¥çš„æ™ºèƒ½æ¨¡å¼åˆ‡æ¢

## ðŸ” éªŒè¯æ¸…å•

è¦ç¡®è®¤SenseVoiceåŠŸèƒ½æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œè¯·æ£€æŸ¥ï¼š

1. âœ… **åº”ç”¨å¯åŠ¨**: æ— å´©æºƒï¼Œæ­£å¸¸åŠ è½½
2. âœ… **è®¾ç½®å¯è§**: "Two-Pass Recognition" é€‰é¡¹å­˜åœ¨
3. âœ… **æ¨¡åž‹æ£€æµ‹**: æ—¥å¿—æ˜¾ç¤º "SenseVoiceæ¨¡åž‹å¯ç”¨"
4. âœ… **è¯†åˆ«å™¨åˆ›å»º**: æ—¥å¿—æ˜¾ç¤º "SenseVoiceè¯†åˆ«å™¨åˆå§‹åŒ–æˆåŠŸ"
5. âœ… **åŒè¯†åˆ«è§¦å‘**: è¯­éŸ³è¾“å…¥æ—¶çœ‹åˆ°ä¸¤é˜¶æ®µæ—¥å¿—
6. âœ… **ç»“æžœå¯¹æ¯”**: æ—¥å¿—ä¸­æ˜¾ç¤ºç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µç»“æžœå¯¹æ¯”

## ðŸš€ ä¸‹ä¸€æ­¥

SenseVoiceåŒè¯†åˆ«åŠŸèƒ½å·²å®Œæ•´å®žçŽ°å¹¶å¯ç”¨ã€‚ç”¨æˆ·å¯ä»¥ç«‹å³åœ¨Dicioä¸­ä½“éªŒæ›´é«˜ç²¾åº¦çš„è¯­éŸ³è¯†åˆ«æ•ˆæžœï¼

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025å¹´9æœˆ19æ—¥  
**çŠ¶æ€**: âœ… åŠŸèƒ½å®Œæ•´ï¼Œå¯æŠ•å…¥ä½¿ç”¨  
**ç‰ˆæœ¬**: withModels (å†…ç½®SenseVoiceæ¨¡åž‹)
